@model List<PaymentModule.Business.Dtos.BusinessDtos.ProductDisplayDto>
@{
    ViewData["Title"] = "Home";
}

<section class="hero-banner">
    <img src="~/images/banner-streetwear.jpg" alt="Streetwear Banner" />
    <div class="hero-text">
        <h1>Legit 'fits that are legit fresh</h1>
        <p>Get streetwear verified by experts with Authenticity Guarantee.</p>
        <button>Shop streetwear</button>
    </div>
</section>

<section class="today-deals">
    <h2>Today's Deals</h2>
    <p>All With Free Shipping</p>

    <div class="deals-container">
        @if (Model != null && Model.Count > 0)
        {
            foreach (var item in Model)
            {
                <div class="deal-card">
                    <img src="@item.Images" alt="@item.Title" />
                    <p class="product-name">@item.Title</p>
                    <p class="price">$@item.Price.ToString("0.00")</p>
                    <button class="btn-add-cart" data-id="@item.Id">Add to cart</button>
                </div>
            }
        }
        else
        {
            <p>No products found.</p>
        }
    </div>
</section>

<script>
       document.addEventListener("DOMContentLoaded", () => {
        document.querySelectorAll(".btn-add-cart").forEach(btn => {
            btn.addEventListener("click", async (e) => {
                const id = e.target.getAttribute("data-id");
                const res = await fetch('/cart/AddToCart', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ productId: id }),
                    credentials: 'include'
                });
                const data = await res.json();
                if (data.success) {
                    // ✅ Không alert, chỉ cập nhật badge
                    if (typeof updateCartCount === "function") updateCartCount();

                    // ✅ Thêm hiệu ứng nhẹ (badge nháy)
                    const badge = document.getElementById("cart-count");
                    if (badge) {
                        badge.style.transform = "scale(1.3)";
                        setTimeout(() => badge.style.transform = "scale(1)", 200);
                    }
                }
            });
        });
    });

</script>

